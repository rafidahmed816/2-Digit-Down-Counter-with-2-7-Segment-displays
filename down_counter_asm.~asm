DATA    SEGMENT
PORTA   EQU 00H   ; Tens digit
PORTB   EQU 02H   ; Units digit
PORT_CON EQU 06H  ; Control Register
DATA    ENDS
#make_bin#
CODE    SEGMENT
ORG 0000H

START:
MOV AX, DATA
MOV DS, AX


MOV DX, PORT_CON
MOV AL, 80H
OUT DX, AL

MOV BL, 99        

MAIN_LOOP:
MOV AL, BL
CALL DISPLAY_TWO_DIGITS

CALL DELAY1        

DEC BL
CMP BL, 255
JNE MAIN_LOOP
MOV BL, 99
JMP MAIN_LOOP


DISPLAY_TWO_DIGITS PROC
PUSH AX
PUSH BX

CMP AL,99
JBE OKVAL
MOV AL,99
OKVAL:
MOV AH, 0
MOV BH, 10
DIV BH      

; Tens digit to PORTA
MOV BL, AL
CALL DIGIT_TO_SEG
MOV DX, PORTA
OUT DX, AL

; Units digit to PORTB
MOV AL, AH
CALL DIGIT_TO_SEG
MOV DX, PORTB
OUT DX, AL

POP BX
POP AX
RET
DISPLAY_TWO_DIGITS ENDP

DIGIT_TO_SEG PROC
CMP AL,0
JE D0
CMP AL,1
JE D1
CMP AL,2
JE D2
CMP AL,3
JE D3
CMP AL,4
JE D4
CMP AL,5
JE D5
CMP AL,6
JE D6
CMP AL,7
JE D7
CMP AL,8
JE D8
CMP AL,9
JE D9
D0: MOV AL,3FH
RET
D1: MOV AL,06H
RET
D2: MOV AL,5BH
RET
D3: MOV AL,4FH
RET
D4: MOV AL,66H
RET
D5: MOV AL,6DH
RET
D6: MOV AL,7DH
RET
D7: MOV AL,07H
RET
D8: MOV AL,7FH
RET
D9: MOV AL,6FH
RET
DIGIT_TO_SEG ENDP


DELAY1 PROC
MOV CX,0FFFFH
DLY0:  NOP
LOOP DLY0
RET
DELAY1 ENDP

CODE ENDS
END START




; [SOURCE]: C:\emu8086\MySource\mycode.asm
